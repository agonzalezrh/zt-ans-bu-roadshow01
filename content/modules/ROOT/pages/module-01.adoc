:notoc:

# 🎯 Ansible Automation Platform - Backup and Snapshot Lab Guide

Welcome to the team! You're about to embark on your automation journey with Ansible. This lab focuses on safe, read-only automation tasks that will help you build confidence without making high-risk changes.

---

## 🔐 Lab Environment Credentials

**Ansible Automation Platform Access:**

| Username | Password    |
|----------|-------------|
| admin    | ansible123! |

**DNS Domain:** `[[ Instruqt-Var key="DOMAIN" hostname="control" ]]`

**Server Inventory:**

| Server         | FQDN                                                    |
|----------------|---------------------------------------------------------|
| Windows Server | windows.[[ Instruqt-Var key="DOMAIN" hostname="control" ]] |
| Node01         | node01.[[ Instruqt-Var key="DOMAIN" hostname="control" ]]  |
| Node02         | node02.[[ Instruqt-Var key="DOMAIN" hostname="control" ]]  |
| Node03         | node03.[[ Instruqt-Var key="DOMAIN" hostname="control" ]]  |

---

## 💻 Exercise 1: Backing up Linux File Systems

### 🎯 Objective
Learn to automate backup processes for Linux servers using XFS snapshots through Ansible Automation Platform.

### ****Step 1: Initial Backup Assessment****

1. Navigate to the **aap** tab in your lab environment
2. Login using the credentials: `admin/ansible123!`
3. Click on the **Menu** dropdown icon (☰)
4. Follow the navigation path: **Automation Execution** → **Templates**
5. Launch the template **Check RHEL Backups** by clicking the 🚀 icon

> 📝 **NOTE:** You should see that no backups are currently available on the system.

.Backup Check
image::/backupcheck.png[]

### ****Step 2: Execute XFS Backup****

1. Return to **Automation Execution** → **Templates**
2. Launch the **Server Backup - XFS/RHEL** template
3. This will create XFS dumps of the file system across all three RHEL nodes

> ⚠️ **IMPORTANT:** This process takes 6-7 minutes to complete. Jobs can run in parallel, so feel free to continue with other tasks and return later.

.XFS Backup
image::xfsbackup.png[XFS]

### ****Step 3: Verify Backup Completion****

1. Once the backup job completes, launch **Check RHEL Backups** again
2. Confirm that backups are now available on each server

.After Backup Check
image::afterbackupcheck.png[BackupCheck2]

> ✅ **SUCCESS:** You have successfully automated the backup process for your Linux file systems!

---

## 🪟 Exercise 2: Windows VSS Snapshots

### 🎯 Objective
Automate Windows Volume Shadow Copy Service (VSS) snapshots to enable database backups without file locking.

### ****Step 1: Create VSS Snapshot****

Windows systems in your environment already have third-party backup tools, but VSS snapshots are essential for database backups as they allow backup operations without interrupting active files.

1. Navigate to **Automation Execution** → **Templates**
2. Launch **Server Snapshot - VSS/Windows**

image::vss-snap.png[WINDOWS_BK]

### ****Step 2: Verify VSS Snapshot****

1. Navigate to **Automation Execution** → **Templates**
2. Execute **Check Windows Backups** to confirm the VSS snapshot was created

image::vss-snap-check.png[WINDOWS_CK]

> ✅ **SUCCESS:** VSS snapshot is now active and available!

### ****Step 3: Configure Automated Scheduling****

Let's set up recurring snapshots to eliminate manual intervention:

1. Navigate to **Automation Execution** → **Templates**
2. Select **Server Backup - VSS/Windows**
3. Click on the **Schedules** tab
4. Click **Create schedule**

image::win-shed.png[WINDOWS_SC]

**Schedule Configuration:**
- **Schedule Name:** `5 Min Snappy`
- **Description:** `Automated VSS Snaps`
- **Start date/time:** Leave as default
- **Time Zone:** Leave as default

**Frequency Settings:**
1. Click **Next**
2. Set **Frequency** to **Minutely**
3. Increase **Interval** to **5**
4. Select **Save rule** and click **Next**
5. Skip exceptions (click **Next**)
6. Click **Finish**

image::shed-details.png[WINDOWS_details]

> ✨ **AUTOMATION ACHIEVED:** Your Windows systems now have automated VSS snapshots running every 5 minutes!

---

## 📋 Code Review: XFS Backup Implementation

For those interested in the underlying automation, here's the key Ansible code powering the XFS backup process:

```yaml
tasks:
  - name: Check if xfsdump is installed
    ansible.builtin.yum:
      name: xfsdump
      state: present
    when: ansible_facts.os_family == "RedHat"

  - name: Ensure the backup directory exists
    ansible.builtin.file:
      path: "{{ backup_file | dirname }}"
      state: directory
      mode: '0755'

  - name: Perform xfsdump backup
    ansible.builtin.command:
      cmd: >
        xfsdump -l 0 -L {{ backup_label }}
        -f {{ backup_file }} {{ xfs_mount_point }}
    register: backup_result
    ignore_errors: no

  - name: Verify xfsdump success
    ansible.builtin.debug:
      msg: "Backup completed successfully: {{ backup_result.stdout }}"
```

---

## 🎉 Lab Summary

### What You've Accomplished:

✅ **Linux File System Backups**
- Automated XFS dump creation across multiple RHEL servers
- Implemented backup verification processes
- Learned safe, read-only automation techniques

✅ **Windows VSS Snapshots**
- Created Volume Shadow Copy Service snapshots
- Verified snapshot functionality
- Configured automated recurring snapshots

✅ **Automation Skills Developed**
- Template execution and monitoring
- Job scheduling and automation
- Multi-platform backup strategies
- Ansible Automation Platform navigation

### Key Benefits Achieved:
- **Risk Mitigation:** Started with safe, read-only operations
- **Confidence Building:** Successful automation of critical backup processes
- **Operational Efficiency:** Eliminated manual backup procedures
- **Cross-Platform Expertise:** Worked with both Linux and Windows systems

> 💡 **TIP:** Use these foundational skills to expand into more complex automation scenarios as your confidence grows!

---

**🚀 Next Steps:** Continue exploring Ansible Automation Platform templates and consider automating other routine maintenance tasks in your environment.
