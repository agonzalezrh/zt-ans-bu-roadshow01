# Ansible Automation Platform Lab Guide

## Welcome to the Team! üéâ

Congratulations on joining the team! This lab will help you get started with automation using Ansible Automation Platform. We'll focus on safe, read-only tasks that will build your confidence before moving to more complex automation scenarios.

---

## üîê Lab Environment Setup

### Access Credentials

| Username | Password    |
|----------|-------------|
| admin    | ansible123! |

---

## üìã Lab Exercise 1: Backing up Linux File Systems

### Overview
You have several Linux servers in your datacenter, and backing up their storage is a common task. With Ansible, you can automate multiple snapshot mechanisms whether your systems are in the cloud, VMs, or bare metal.

### **Step 1: Check Existing Backups**

1. Navigate to the lab `aap` tab and login using the credentials above (`admin/ansible123!`)
2. Click on the Menu dropdown icon (hamburger menu ‚ò∞)
3. Navigate to **Automation Execution** ‚Üí **Templates**
4. Launch the template **Check RHEL Backups**
   
   > üí° **TIP:** You can launch templates quickly by clicking on the üöÄ rocket icon.

5. Once the job completes, you should see that no backups are currently available

![Initial backup check showing no backups available](backupcheck.png)

### **Step 2: Create XFS Backups**

1. Navigate back to **Automation Execution** ‚Üí **Templates**
2. Launch the **Server Backup - XFS/RHEL** template
3. This will backup your three RHEL nodes by creating XFS dumps of the file systems

![XFS backup job running](xfsbackup.png)

> ‚ö†Ô∏è **IMPORTANT:** This process takes 6-7 minutes to complete. Feel free to continue with other tasks and return to check the results later. Jobs can run safely in parallel!

### **Step 3: Verify Backup Creation**

Once the backup has completed:

1. Launch the **Check RHEL Backups** template again
2. Verify that backups are now available for each server
3. You should see successful backup creation for all volume backups

![Backup check showing successful backups](afterbackupcheck.png)

> üìù **NOTE:** You can skip this step initially and return later if the backup is still running.

---

## üìã Lab Exercise 2: Windows Snapshots

### Overview
Now that you have backups of your RHEL systems, let's work with Windows systems. Windows has excellent built-in snapshotting functionality that we can automate with Ansible.

Your Windows environment already has a backup strategy using third-party tools, but we need VSS (Volume Shadow Copy Service) snapshots for databases since they allow backups without locking or interrupting active files.

### **Step 1: Create VSS Snapshots**

1. Navigate to **Automation Execution** ‚Üí **Templates**
2. Launch the **Server Snapshot - VSS/Windows** template

![Windows VSS snapshot job](vss-snap.png)

### **Step 2: Verify VSS Snapshots**

Once the snapshot job completes:

1. Navigate to **Automation Execution** ‚Üí **Templates**
2. Execute the **Check Windows Backups** template

![VSS snapshot verification results](vss-snap-check.png)

Excellent! You can see that the VSS snapshot was created successfully.

### **Step 3: Schedule Automated Snapshots**

Let's configure a schedule to automate these snapshots without manual intervention:

1. Navigate to **Automation Execution** ‚Üí **Templates**
2. Select **Server Backup - VSS/Windows**
3. Click on the **Schedules** tab
4. Click **Create schedule**

![Windows schedule configuration](win-shed.png)

#### Schedule Configuration

Configure the schedule with these details:

| Field            | Value                    |
|------------------|--------------------------|
| Schedule Name    | 5 Min Snappy            |
| Description      | Automated VSS Snaps     |
| Start date/time  | <Leave default>         |
| Time Zone        | <Leave default>         |

5. Click **Next**
6. Configure **Frequency**:
   - Set to "Minutely"
   - Set interval to 5 minutes
   - Select **Save rule**
7. Click **Next**
8. Skip exceptions (click **Next**)
9. Click **Finish**

![Completed schedule configuration](shed-details.png)

Perfect! Your automated snapshots are now configured and will run every 5 minutes.

---

## üíª Code Reference

### XFS Backup Automation Code

Here's the key Ansible code used for XFS backups:

```yaml
tasks:
  - name: Check if xfsdump is installed
    ansible.builtin.yum:
      name: xfsdump
      state: present
    when: ansible_facts.os_family == "RedHat"

  - name: Ensure the backup directory exists
    ansible.builtin.file:
      path: "{{ backup_file | dirname }}"
      state: directory
      mode: '0755'

  - name: Perform xfsdump backup
    ansible.builtin.command:
      cmd: >
        xfsdump -l 0 -L {{ backup_label }}
        -f {{ backup_file }} {{ xfs_mount_point }}
    register: backup_result
    ignore_errors: no

  - name: Verify xfsdump success
    ansible.builtin.debug:
      msg: "Backup completed successfully: {{ backup_result.stdout }}"
```

---

## üéØ Summary

You've successfully completed:

‚úÖ **Exercise 1:** Linux File System Backups
- Checked existing backup status
- Created XFS backups for RHEL systems
- Verified backup creation

‚úÖ **Exercise 2:** Windows VSS Snapshots  
- Created VSS snapshots for Windows systems
- Verified snapshot creation
- Configured automated scheduling

This introspection use case is a great way to get comfortable with automation while gaining valuable information and building confidence for future automation projects.
