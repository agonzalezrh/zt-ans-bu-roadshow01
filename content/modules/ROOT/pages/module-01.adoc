# Ansible Automation Platform Lab Guide
:notoc:

🎯 **Welcome to the Ansible Automation Team!**

This lab guide will help you get started with automation by focusing on safe, read-only tasks that build confidence while gathering valuable system information. You'll learn to automate backups, generate reports, and schedule tasks across Linux and Windows environments.

---

## 🔐 Lab Environment Setup

### **Credentials**
| Username | Password |
|----------|----------|
| admin    | ansible123! |

### **DNS Domain**
Your DNS domain: **[[ Instruqt-Var key="DOMAIN" hostname="control" ]]**

### **Server Information**
| Server | FQDN |
|--------|------|
| Windows Server | windows.[[ Instruqt-Var key="DOMAIN" hostname="control" ]] |
| Node01 | node01.[[ Instruqt-Var key="DOMAIN" hostname="control" ]] |
| Node02 | node02.[[ Instruqt-Var key="DOMAIN" hostname="control" ]] |
| Node03 | node03.[[ Instruqt-Var key="DOMAIN" hostname="control" ]] |

---

## 📋 Module 1: Backup Automation

### ☑️ **Exercise 1: Linux File System Backups**

**Step 1: Check Current Backup Status**
1. Navigate to the lab **aap** tab and login with credentials (`admin/ansible123!`)
2. Click the Menu dropdown (hamburger icon)
3. Navigate to **Automation Execution** → **Templates**
4. Launch the **Check RHEL Backups** template using the 🚀 icon

💡 **Expected Result:** You should see no backups are currently available

.Backup Check
image::/backupcheck.png[]

**Step 2: Create XFS Backups**
1. Navigate back to **Automation Execution** → **Templates**
2. Launch **Server Backup - XFS/RHEL** template
3. This will backup your three RHEL nodes by creating XFS dumps

⚠️ **IMPORTANT:** This process takes 6-7 minutes. Jobs can run in parallel safely!

.XFS Backup
image::xfsbackup.png[XFS]

**Step 3: Verify Backup Creation**
1. Once backup completes, launch **Check RHEL Backups** template again
2. Confirm backups are now available

.After Backup Check
image::afterbackupcheck.png[BackupCheck2]

### ☑️ **Exercise 2: Windows VSS Snapshots**

**Step 1: Create VSS Snapshots**
Windows systems require snapshots for database backups without file locking. Let's automate the built-in VSS functionality.

1. Navigate to **Automation Execution** → **Templates**
2. Launch **Server Snapshot - VSS/Windows**

image::vss-snap.png[WINDOWS_BK]

**Step 2: Verify VSS Snapshots**
1. Navigate to **Automation Execution** → **Templates**
2. Execute **Check Windows Backups**

image::vss-snap-check.png[WINDOWS_CK]

✨ **Success!** The VSS snapshot is now available.

**Step 3: Schedule Automated Snapshots**
1. Navigate to **Automation Execution** → **Templates**
2. Select **Server Backup - VSS/Windows**
3. Navigate to the **Schedules** tab
4. Click **Create schedule**

image::win-shed.png[WINDOWS_SC]

**Schedule Configuration:**
- **Schedule Name:** `5 Min Snappy`
- **Description:** `Automated VSS Snaps`
- **Start date/time:** Leave as default
- **Time Zone:** Leave as default

5. Click **Next**
6. Configure **Frequency** to **Minutely**
7. Set **Interval** to **5**
8. Select **Save rule** and click **Next**
9. Skip exceptions by clicking **Next**
10. Click **Finish**

image::shed-details.png[WINDOWS_details]

### 💻 **Code Snippets: XFS Backup Automation**

```yaml
tasks:
  - name: Check if xfsdump is installed
    ansible.builtin.yum:
      name: xfsdump
      state: present
    when: ansible_facts.os_family == "RedHat"

  - name: Ensure the backup directory exists
    ansible.builtin.file:
      path: "{{ backup_file | dirname }}"
      state: directory
      mode: '0755'

  - name: Perform xfsdump backup
    ansible.builtin.command:
      cmd: >
        xfsdump -l 0 -L {{ backup_label }}
        -f {{ backup_file }} {{ xfs_mount_point }}
    register: backup_result
    ignore_errors: no

  - name: Verify xfsdump success
    ansible.builtin.debug:
      msg: "Backup completed successfully: {{ backup_result.stdout }}"
```
