= Ansible Automation Platform - System Backup Lab
:toc: left
:toclevels: 3
:icons: font
:numbered:

== Welcome to Your First Automation Lab!

*Congratulations on joining the team!* 

This lab introduces you to automation using Ansible Automation Platform through safe, read-only operations. You'll learn to automate system introspection tasks, building confidence to tackle more complex automation challenges.

[IMPORTANT]
====
This is a *read-only* automation lab designed for safe learning. You can explore automation without making high-risk changes to systems.
====

== Lab Environment Setup

=== Authentication Credentials

Use these credentials to access your Ansible Automation Platform instance:

[cols="1,1", options="header"]
|===
| Username | Password
| admin    | ansible123!
|===

=== Lab Infrastructure

Your DNS domain for this lab is: *[[ Instruqt-Var key="DOMAIN" hostname="control" ]]*

[cols="1,2", options="header"]
|===
| Server        | FQDN
| Windows Server| windows.[[ Instruqt-Var key="DOMAIN" hostname="control" ]]
| Node01        | node01.[[ Instruqt-Var key="DOMAIN" hostname="control" ]]
| Node02        | node02.[[ Instruqt-Var key="DOMAIN" hostname="control" ]]
| Node03        | node03.[[ Instruqt-Var key="DOMAIN" hostname="control" ]]
|===

== Exercise 1: Linux File System Backups

Linux servers require regular backup maintenance. With Ansible, you can automate various snapshot mechanisms across cloud, VM, and bare-metal environments.

=== Step 1: Check Current Backup Status

. Navigate to the *aap* tab and login with your credentials (`admin/ansible123!`)
. Click the *Menu* dropdown icon (hamburger menu)
. Navigate to *Automation Execution* > *Templates*
. Launch the template *Check RHEL Backups* by clicking the ðŸš€ icon

[NOTE]
====
Templates can be launched quickly using the rocket (ðŸš€) icon next to each template name.
====

After job completion, you should see no backups are currently available.

.Initial Backup Check Results
image::backupcheck.png[No backups found]

=== Step 2: Create XFS File System Backups

Now let's create backups of the XFS file systems on your RHEL servers:

. Return to *Automation Execution* > *Templates*
. Launch the *Server Backup - XFS/RHEL* template
. This will backup all three RHEL nodes using XFS dumps

[WARNING]
====
This backup process takes 6-7 minutes to complete. Jobs can run in parallel, so feel free to continue with other exercises and return to check progress later.
====

.XFS Backup Process
image::xfsbackup.png[XFS backup in progress]

=== Step 3: Verify Backup Creation

Once the backup completes:

. Launch the *Check RHEL Backups* template again
. Confirm that backups are now available on each server

[TIP]
====
You can skip this verification step initially and return later if the backup process is still running.
====

.Successful Backup Verification
image::afterbackupcheck.png[Backups successfully created]

== Exercise 2: Windows System Snapshots

Windows systems include built-in Volume Shadow Copy Service (VSS) for creating snapshots. While your organization uses third-party backup tools, VSS snapshots are essential for database backups as they don't interrupt active files.

=== Step 1: Create VSS Snapshots

. Navigate to *Automation Execution* > *Templates*
. Launch the *Server Snapshot - VSS/Windows* template

.Windows VSS Snapshot Creation
image::vss-snap.png[Windows VSS snapshot process]

=== Step 2: Verify VSS Snapshots

After completion, confirm the VSS snapshot was created:

. Navigate to *Automation Execution* > *Templates*
. Execute the *Check Windows Backups* template

.VSS Snapshot Verification
image::vss-snap-check.png[VSS snapshot verification]

[NOTE]
====
Successful completion shows that VSS snapshots are properly configured and functional.
====

== Exercise 3: Automated Scheduling

Eliminate manual intervention by scheduling recurring snapshots automatically.

=== Configure Automated VSS Snapshots

. Navigate to *Automation Execution* > *Templates*
. Select *Server Backup - VSS/Windows*
. Click the *Schedules* tab
. Click *Create schedule*

.Schedule Configuration Interface
image::win-shed.png[Windows schedule configuration]

=== Schedule Parameters

Configure your schedule with these settings:

[cols="1,2", options="header"]
|===
| Parameter | Value
| Schedule Name | 5 Min Snappy
| Description | Automated VSS Snaps
| Start date/time | _Leave as default_
| Time Zone | _Leave as default_
|===

=== Frequency Configuration

. Click *Next*
. Set *Frequency* to *Minutely*
. Increase *Interval* to *5*
. Select *Save rule* and click *Next*
. Skip exceptions (click *Next*)
. Click *Finish*

.Schedule Configuration Details
image::shed-details.png[Detailed schedule settings]

[TIP]
====
Your automated snapshots are now configured! Check back later to verify the schedule is working correctly.
====

== Technical Reference: Code Snippets

For those interested in the underlying automation code, here are key snippets:

=== XFS Backup Automation

[source,yaml]
----
tasks:

- name: Check if xfsdump is installed
  ansible.builtin.yum:
    name: xfsdump
    state: present
  when: ansible_facts.os_family == "RedHat"

- name: Ensure the backup directory exists
  ansible.builtin.file:
    path: "{{ backup_file | dirname }}"
    state: directory
    mode: '0755'

- name: Perform xfsdump backup
  ansible.builtin.command:
    cmd: >
      xfsdump -l 0 -L {{ backup_label }}
      -f {{ backup_file }} {{ xfs_mount_point }}
  register: backup_result
  ignore_errors: no

- name: Verify xfsdump success
  ansible.builtin.debug:
    msg: "Backup completed successfully: {{ backup_result.stdout }}"
----

== Summary

Congratulations! You have successfully:

* âœ… Created automated backups for Linux XFS file systems
* âœ… Implemented Windows VSS snapshots
* âœ… Configured automated scheduling for recurring snapshots
* âœ… Verified backup operations across multiple systems

[IMPORTANT]
====
This lab demonstrates the power of Ansible automation for routine system maintenance tasks. These read-only operations provide a safe foundation for exploring more advanced automation scenarios.
====

You're now ready to tackle more complex automation challenges with confidence!
