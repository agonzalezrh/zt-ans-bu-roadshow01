# üöÄ Ansible Automation Platform - Backup & Snapshot Lab Guide

---

## üéØ Welcome to Your Automation Journey!

**Congratulations on joining the team!** 

You have just joined the team! There are so many things you can automate but it can be daunting in starting with automation. A number of your tasks are read only, meaning you can safely automate without making any high risk changes. This introspection use case is great way to get comfortable automating in order to gain information as well as confidence to automate more as you go.

> üí° **TIP:** This lab focuses on safe, read-only operations that are perfect for building automation confidence without risk.

---

## üîê Lab Environment Credentials

### **Ansible Automation Platform Access**

| Username | Password |
|----------|----------|
| **admin** | **ansible123!** |


## ‚òëÔ∏è Exercise 1: Backing up Linux File Systems

### üéØ **Objective**
Learn how to automate Linux file system backups using Ansible across multiple servers. You have a few Linux servers in your datacenter and a common task is backing up their storage. With Ansible you can drive multiple snapshot mechanisms, if its on the cloud, in VMs, or baremetal you can use Ansible to drive backups.

### **Step 1: Initial Backup Assessment**

1. Navigate to the lab **`aap`** tab and login using the credentials above (**admin/ansible123!**)

2. Click on the **Menu dropdown icon** (hamburger menu ‚ò∞)

3. Navigate to **Automation Execution** ‚Üí **Templates**

4. Launch the template **Check RHEL Backups**
   > üíª **Quick Launch:** Click the üöÄ icon for faster template execution

5. Once the job is complete, you should see there are **no backups available**

.Backup Check
image::backupcheck.png[]

### **Step 2: Execute XFS File System Backup**

1. Navigate back to **Automation Execution** ‚Üí **Templates**

2. Launch **Server Backup - XFS/RHEL**

3. This will backup your three RHEL nodes by creating **XFS dumps** of the file system

> ‚ö†Ô∏è **IMPORTANT:** This process takes **6-7 minutes** - feel free to continue with other exercises and return later. Jobs can run in parallel safely and easily!

.XFS Backup
image::xfsbackup.png[]

### **Step 3: Verify Backup Completion**

1. Once the backup has completed, you should see successful volume backups on each server

2. Launch the **Check RHEL Backups** template again to verify backups are available

3. You can skip this step initially and return later if the backup is still processing

.After Backup Check
image::afterbackupcheck.png[]

---

## ‚òëÔ∏è Exercise 2: Windows VSS Snapshots

### üéØ **Objective**
Implement automated Windows Volume Shadow Copy Service (VSS) snapshots for database backup strategies.

So now that you have some backups of your RHEL systems, what about our Windows systems? Windows has a great snapshotting function built-in so lets automate it. Your Windows environment has a backup strategy already with third party tools in our organization but we need to have snapshots of the systems for our databases since snapshots allow backups to be taken without locking or interrupting active files.

### **Step 1: Create VSS Snapshot**

1. Navigate to **Automation Execution** ‚Üí **Templates**

2. Launch **Server Snapshot - VSS/Windows**

.VSS
image::vss-snap.png[]

### **Step 2: Verify VSS Snapshot**

1. Once completed, confirm the VSS snapshot creation

2. Navigate to **Automation Execution** ‚Üí **Templates**

3. Execute **Check Windows Backups**

.VSSSnap
image::vss-snap-check.png[]

**Awesome!** ‚ú® We can see that the VSS snapshot is there!

### **Step 3: Configure Automated Scheduling**

Let's configure a schedule so we can drive these snapshots without having to trigger the templates manually. This means we can have a re-occurring snapshot without any hassle.

1. Navigate to **Automation Execution** ‚Üí **Templates**

2. Select **Server Backup - VSS/Windows**

3. Navigate to the **Schedules** tab

4. Click **Create schedule**

.WindowsSche
image::win-shed.png[]

### **Step 4: Schedule Configuration Details**

Configure the schedule with the following parameters:

| Field | Value |
|-------|-------|
| **Schedule Name** | `5 Min Snappy` |
| **Description** | `Automated VSS Snaps` |
| **Start date/time** | `<Leave as is>` |
| **Time Zone** | `<Leave as is>` |

1. Click **Next**

2. Configure **Frequency** settings:
   - **Frequency:** Minutely
   - **Interval:** 5 minutes
   - Select **Save rule**
   - Click **Next**

3. **Exceptions:** No exceptions needed - click **Next**

4. Click **Finish** to complete the schedule setup

.Schedule
image::shed-details.png[]

> ‚úÖ **Great!** We can check on this automated schedule later!

---

## üíª Code Snippets for Review

### üîç **XFS Backup Automation Code**

Here's the key Ansible code for automating XFS backups:

```yaml
tasks:

- name: Check if xfsdump is installed
  ansible.builtin.yum:
    name: xfsdump
    state: present
  when: ansible_facts.os_family == "RedHat"

- name: Ensure the backup directory exists
  ansible.builtin.file:
    path: "{{ backup_file | dirname }}"
    state: directory
    mode: '0755'

- name: Perform xfsdump backup
  ansible.builtin.command:
    cmd: >
      xfsdump -l 0 -L {{ backup_label }}
      -f {{ backup_file }} {{ xfs_mount_point }}
  register: backup_result
  ignore_errors: no

- name: Verify xfsdump success
  ansible.builtin.debug:
    msg: "Backup completed successfully: {{ backup_result.stdout }}"
```

> üìù **NOTE:** This code demonstrates how Ansible can automate complex backup operations across multiple Linux systems simultaneously.

---

## üéâ Lab Summary & Completion Checklist

### ‚úÖ **What You've Accomplished**

- ‚úÖ **Linux Backup Automation:** Successfully implemented XFS file system backups across multiple RHEL servers
- ‚úÖ **Windows Snapshot Management:** Automated VSS snapshot creation for Windows systems  
- ‚úÖ **Scheduling Automation:** Configured recurring automated snapshots without manual intervention
- ‚úÖ **Verification Processes:** Learned to validate backup completion and success
- ‚úÖ **Multi-Platform Management:** Demonstrated cross-platform automation capabilities

### üöÄ **Key Learning Outcomes**

1. **Safe Automation Practice:** Started with read-only operations to build confidence
2. **Parallel Processing:** Experienced how Ansible can manage multiple systems simultaneously
3. **Scheduling Capabilities:** Learned to automate recurring tasks without manual intervention
4. **Cross-Platform Skills:** Worked with both Linux and Windows automation
5. **Verification Best Practices:** Implemented proper backup validation procedures

### üìã **Next Steps**

> üí° **TIP:** Now that you've mastered these backup automation techniques, you're ready to tackle more complex automation challenges with confidence!

---

**üéØ Congratulations on completing the Ansible Automation Platform Backup & Snapshot Lab!**
